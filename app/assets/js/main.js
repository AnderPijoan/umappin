// Generated by CoffeeScript 1.6.2
(function() {
  window.setTemplate = function(url, callback) {
    $('div#actionResult').empty();
    $('div#actionResult').css('display', 'none');
    return $.get(url, function(template) {
      $('div#content').empty().html(template);
      return callback != null ? callback.call(this) : void 0;
    });
  };

  window.updateSessionViews = function(username) {
    $('.loggedout').css('display', username !== "" ? 'none' : 'block');
    return $('.loggedin').css('display', username !== "" ? 'block' : 'none').find('#username').text(username);
  };

  $(function() {
    var json, sessionRequest, usr;

    window.umappin = window.umappin || {};
    requirejs(['/assets/js/router.js'], function() {
      umappin.router || (umappin.router = new umappin.Router);
      return Backbone.history.start();
    });
    json = sessionStorage.getItem("user");
    if ((json != null) && json !== "") {
      usr = JSON.parse(json);
      return updateSessionViews(usr.name);
    } else {
      sessionRequest = $.get("/sessionuser");
      sessionRequest.done(function(data) {
        updateSessionViews(data.name);
        return sessionStorage.setItem("user", JSON.stringify(data));
      });
      return updateSessionViews("");
    }
  });

}).call(this);
