<div class="box-transparent span12">Don't ask about me. I don't exist. I'm an illusion ;)</div>
<div class="box-transparent span3 offset9">
    <div class="row">
        <form action='/login' id='loginForm' class="span3">
            <div class="input-prepend">
                <div class="add-on"><span class="icon-envelop"></span></div>
                <input type="text" id="email_login" name="email_login" class="span3" placeholder="User email">
            </div>
            <div class="input-prepend">
                <div class="add-on"><span class="icon-key"></span></div>
                <input type="password" id="password_login" name="password_login" class="span3" placeholder="Password">
            </div>
            <input type="submit" value="Log in" class="btn btn-primary span3">
            <h6><a href="#forgotPassword" data-toggle="modal">Forgot your password?</a></h6>
        </form>
    </div>
</div>
<div class="box-transparent span3 offset9">
    <div class="row">
        <form action="/signup" id='registerForm' class="span3">
            <h4>New to uMappin? Sign up</h4>
            <div class="input-prepend">
                <div class="add-on"><span class="icon-users"></span></div>
                <input type="text" id="name" name="name" placeholder="Username" class="span3">
            </div>
            <div class="input-prepend">
                <div class="add-on"><span class="icon-envelop"></span></div>
                <input type="text" id="email" name="email"  placeholder="Email" class="span3">
            </div>
            <div class="input-prepend">
                <div class="add-on"><span class="icon-key"></span></div>
                <input type="password" id="password" name="password" placeholder="Password"  class="span3">
            </div>
            <div class="input-prepend">
                <div class="add-on"><span class="icon-key"></span></div>
                <input type="password" id="repeatPassword" name="repeatPassword" placeholder="Retype password" class="span3">
            </div>
            <input type="submit" value="Sign up" class="btn btn-primary span3">
        </form>
    </div>
</div>
<!-- Modal -->
<form action="/login/password/forgot" id="forgotPasswordForm">
<div id="forgotPassword" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="forgotPasswordLabel" aria-hidden="true">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
        <h3 id="forgotPasswordLabel">Find your account</h3>
    </div>
    <div class="modal-body">
        <div class="input-prepend">
            <div class="add-on"><span class="icon-envelop"></span></div>
            <input type="text" id="email_forgot" name="email_forgot" class="span3" placeholder="User email">
        </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-free" data-dismiss="modal" aria-hidden="true">Close</button>
        <button type="submit" class="btn btn-primary">Search</button>
    </div>
</div>
</form>
<script>

    function submitLogin() {
        var loginPost = $.post(
          $('#loginForm').attr('action'),
          "email=" + $('#email_login').val() + "&password=" + $('#password_login').val()
        );
        loginPost.done(function( data ) {
            $.get(
                '/sessionuser',
                function(data) {
                    updateSessionViews(data.name);
                    location.href='./'
                }
            );
        });
        loginPost.error(function( data ) {
            location.href='./#login';
        });
    }

    $('#loginForm').submit(function(event) {
        event.preventDefault();
        submitLogin();
    });

    function submitRegister() {
        var registerPost = $.post(
                $('#registerForm').attr('action'),
                "name=" + $('#name').val() + "&email=" + $('#email').val() +
                    "&password=" + $('#password').val() + "&repeatPassword=" + $('#repeatPassword').val()
        );
        registerPost.done(function( data ) {
            location.href='./';
        });
        registerPost.error(function( data ) {
            location.href='./#signup';
        });
    }

    $('#registerForm').submit(function(event) {
        event.preventDefault();
        submitRegister();
    });
    function submitForgotPassword() {
        var forgotPasswordPost = $.post(
                $('#forgotPasswordForm').attr('action'),
                "email=" + $('#email_forgot').val()
        );
        forgotPasswordPost.done(function( data ) {
            //location.href='./';
        });
        forgotPasswordPost.error(function( data ) {
            //location.href='./';
        });
    }

    $('#forgotPasswordForm').submit(function(event) {
        event.preventDefault();
        submitForgotPassword();
    });
</script>